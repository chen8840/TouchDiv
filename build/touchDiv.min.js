!function(){"use strict";function a(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)}window.touchDiv=function(b,c){function d(){var a=v,d=w;v+=m,w+=n,v>0&&(v=0),w>0&&(w=0,c.scrollDivToTop&&c.scrollDivToTop()),v<-(h.scrollWidth-h.clientWidth)&&(v=-(h.scrollWidth-h.clientWidth)),w<-(h.scrollHeight-b.clientHeight)&&(w=-(h.scrollHeight-b.clientHeight),c.scrollDivToBottom&&c.scrollDivToBottom()),d==w&&a==v||(h.style.transform="translate3d("+v+"px,"+w+"px,0px)")}function e(){var a=i.style;a.height=Math.max(10,Math.floor(b.clientHeight*b.clientHeight/b.scrollHeight))+"px",a.top=Math.floor(-w*b.clientHeight/b.scrollHeight)+"px"}function f(){var a=j.style;a.width=Math.max(10,Math.floor(h.clientWidth*h.clientWidth/h.scrollWidth))+"px",a.left=Math.floor(-v*h.clientWidth/h.scrollWidth)+"px"}function g(a,b,c){!function(a,b,c){if("ontouchend"in document)switch(b){case"touchstart":a.addEventListener("touchstart",function(a){c(a,a.touches[0].clientX,a.touches[0].clientY)},!1);break;case"touchmove":a.addEventListener("touchmove",function(a){c(a,a.touches[0].clientX,a.touches[0].clientY)},!1);break;case"touchend":a.addEventListener("touchend",function(a){c(a,void 0,void 0)},!1)}else switch(b){case"touchstart":a.addEventListener("mousedown",function(b){a._mousedown=!0,c(b,b.clientX,b.clientY)},!1);break;case"touchmove":a.addEventListener("mousemove",function(b){a._mousedown&&c(b,b.clientX,b.clientY)},!1);break;case"touchend":a.addEventListener("mouseup",function(b){a._mousedown&&(a._mousedown=!1,c(b,b.clientX,b.clientY))},!1),a.addEventListener("mouseout",function(b){a._mousedown&&(a._mousedown=!1,c(b,b.clientX,b.clientY))},!1)}}(a,b,c)}1==b.nodeType&&"div"==b.tagName.toLowerCase()||console.warn("touchDiv's param is not a div element."),b.style.position="relative",b.style.overflow="hidden";var h=document.createElement("div");h.innerHTML=b.innerHTML,b.innerHTML="",b.appendChild(h),h.offsetHeight<b.clientHeight&&(h.style.height="100%");var i=document.createElement("div");i.style.position="absolute",i.style.width="4px",i.style.right="1px",i.style.backgroundColor="gray",i.style.zIndex="9999999",i.style.opacity="0.8",i.style.display="none",b.appendChild(i);var j=document.createElement("div");j.style.position="absolute",j.style.height="4px",j.style.bottom="1px",j.style.backgroundColor="gray",j.style.zIndex="9999999",j.style.opacity="0.8",j.style.display="none",b.appendChild(j);var k,l,m,n,o,p,q,r,s,t,u=[],v=0,w=0;g(b,"touchstart",function(c,d,g){a()&&c.preventDefault(),c.stopPropagation(),p&&(clearTimeout(p),p=void 0),k=d,l=g,i.style.display=j.style.display="block",i.style.opacity=j.style.opacity="0.8",e(),f(),i.clientHeight>=b.clientHeight&&(i.style.display="none"),j.clientWidth>=b.clientWidth&&(j.style.display="none"),o=void 0,u=[],q=s=t=r=void 0,0>=-w&&(q=!0),-w+b.clientHeight>=b.scrollHeight&&(s=!0)}),g(b,"touchmove",function(a,b,g){a.stopPropagation(),m=b-k,n=g-l,k=b,l=g,d(),e(),f(),c.scrollDivTouchMove&&c.scrollDivTouchMove();var h=new Date;void 0!==o&&h-o!==0&&u.push({x:m/(h-o),y:n/(h-o)}),o=h}),g(b,"touchend",function(a){function g(){m=n=0,(h>100||-100>h)&&(m=20*h/1e3,h/=1.05),(k>100||-100>k)&&(n=20*k/1e3,k/=1.05),0!==m||0!==n?(d(),e(),f(),p=setTimeout(g,20)):l>0?(i.style.opacity=j.style.opacity=(.8-(15-l)/15).toFixed(1)+"",l--,p=setTimeout(g,30)):(i.style.display=j.style.display="none",p=void 0)}a.stopPropagation(),0>=-w&&(r=!0),-w+b.clientHeight>=b.scrollHeight&&(t=!0),q&&r&&n>0&&c.topToTopFunc&&c.topToTopFunc(),s&&t&&0>n&&c.buttomToButtomFunc&&c.buttomToButtomFunc();for(var h=0,k=0,l=15,o=0;o<u.length;o++)h+=u[o].x,k+=u[o].y;u.length>0&&(h=1e3*h/u.length,k=1e3*k/u.length),Math.sqrt(m*m+n*n)<5&&(h=k=0),p=setTimeout(g,20)})},"function"==typeof define&&define.amd&&define("touchDiv",[],function(){return window.touchDiv})}();